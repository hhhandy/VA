---
title: "Take-home Exercise 4"
description: |
  In this take home exercise I will reveal the daily routines of two selected participants.
author:
  - name: Heranshan Subramaniam
    url: https://www.linkedin.com/in/heranshan/
    affiliation: School of Computing and Information Systems
    affiliation_url: https://scis.smu.edu.sg/
date: "`r Sys.Date()`"
output: distill::distill_article
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, message = FALSE,
                      warning = FALSE, fig.retina = 3)
```

# Overview

In this take-home exercise, I will explore the daily life pattern of the least and most jovial participant with the use of the (ViSiElse)[https://cran.r-project.org/web/packages/ViSiElse/index.html] package. 

# Getting Started

The required packages will be called with the following code chunk:

```{r}
packages = c('tidyverse', "ViSiElse", "lubridate")

for (p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p,character.only = T)
}
```

# Importing Data


## Import Participant Data
The code chunk below will import *Participants.csv* from the data folder into R by using [`read_csv()`](https://readr.tidyverse.org/reference/read_delim.html) of [**readr**](https://readr.tidyverse.org/) package and save it as a tibble data frame called *Participant*.

```{r}
Participants <- read_csv("data/Participants.csv")

```

## Find Participant with the Highest and Lowest Joviality

```{r, eval=FALSE}
participantMaxJ <- Participants$participantId[Participants$joviality 
                                              == max(Participants$joviality)]

participantMinJ <- Participants$participantId[Participants$joviality 
                                              == min(Participants$joviality)]

selectedParticipantsJov <- c(participantMinJ, participantMaxJ)

print(paste("Participant with max joviality is: ", participantMaxJ, ".",
            "Participant with min joviality is: ", participantMinJ, sep=""))
```
Participant with the highest joviality is participant 113 and participant with the lowest joviality is participant 758.

```{r, eval=FALSE}
participantMaxA <- Participants$participantId[Participants$age
                                              == max(Participants$age)][1]

participantMinA <- Participants$participantId[Participants$age 
                                              == min(Participants$age)][1]

selectedParticipantsAge <- c(participantMinA, participantMaxA)

print(paste("Participant with max age is: ", participantMaxA, ".",
            "Participant with min age is: ", participantMinA, sep=""))
```

```{r}
print(subset(Participants, Participants$participantId %in% c(113,758)))
```

## Import Participant Log

```{r, eval=FALSE}
allFiles <- dir(path = "data/Activity Logs/", full.names = TRUE)

ParticipantsLogJov <- NULL

for (i in allFiles) {
  temp <- read_csv(i)
  
  temp <- subset(temp, temp$participantId %in% selectedParticipantsJov)
  
  ParticipantsLogJov <- rbind(ParticipantsLogJov, temp)
  
  temp <- NULL
}

```

## Clean ParticipantsLog

```{r, eval=FALSE}
keep <- c("participantId", "timestamp", "currentMode", "sleepStatus")

ParticipantsLogJov <- ParticipantsLogJov[, keep]

```

# Introduce day field
```{r}
ParticipantsLogJov <-ParticipantsLogJov %>%
  mutate(day = weekdays(timestamp)) 
```

```{r}

weekday <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")
weekend <- c("Saturday", "Sunday")

Participant758Weekday <- ParticipantsLogJov %>%
  filter(day %in% weekday) %>%
  filter(participantId == 758)

Participant758Weekend <- ParticipantsLogJov %>%
  filter(day %in% weekend) %>%
  filter(participantId == 758)

Participant113Weekday <- ParticipantsLogJov %>%
  filter(day %in% weekday) %>%
  filter(participantId == 113)

Participant113Weekend <- ParticipantsLogJov %>%
  filter(day %in% weekend) %>%
  filter(participantId == 113)

keep <- c("timestamp", "currentMode", "sleepStatus", "day")
Participant758Weekday <- Participant758Weekday[, keep]
Participant758Weekend <- Participant758Weekend[, keep]
Participant113Weekday <- Participant113Weekday[, keep]
Participant113Weekend <- Participant113Weekend[, keep]

```

# Participant 758 Weekday

## Data Prep for Participant 758 Weekday

### Create minutes and date column 

```{r, eval=FALSE}
Participant758Weekday <- Participant758Weekday %>%
  mutate(minutes = hour(timestamp)*60 + minute(timestamp))
```

```{r, eval=FALSE}
Participant758Weekday <- Participant758Weekday %>%
  mutate(date = date(timestamp))
```

```{r, eval=FALSE}
Participant758Weekday$status <- paste(Participant758Weekday$currentMode, 
                               Participant758Weekday$sleepStatus, sep="-")
```

### Wake up

```{r, eval=FALSE}
P758WeekdaySummary <- Participant758Weekday %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(P758WeekdaySummary) = c("Dates", "WakeUp")
```

```{r, eval=FALSE}
P758WeekdaySummary$Sleep <- Participant758Weekday %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

### Transport

#### Transport Day Start

```{r, eval=FALSE}
TransportWeekDay758 <- Participant758Weekday %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes <= 720) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekDay758) = c("Dates", "TransportDayStart")
```

```{r, eval=FALSE}
P758WeekdaySummary$TransportDayStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekDay758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$TransportDayStart[as.character(P758WeekdaySummary$Dates)
                                       == i] =
        TransportWeekDay758$TransportDayStart[as.character(TransportWeekDay758$Dates) == i]
      
    }
  }
}
```

#### Transport Evening Start

```{r, eval=FALSE}
TransportWeekDay758 <- Participant758Weekday %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes > 1035) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekDay758) = c("Dates", "TransportEveningStart")
```

```{r, eval=FALSE}
P758WeekdaySummary$TransportEveningStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekDay758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$TransportEveningStart[as.character(P758WeekdaySummary$Dates)
                                       == i] =
        TransportWeekDay758$TransportEveningStart[as.character(TransportWeekDay758$Dates) == i]
      
    }
  }
}
```

#### Back Home

```{r, eval=FALSE}
P758WeekdaySummary$Backhome <- Participant758Weekday %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

#### WorkStart

```{r, eval=FALSE}
WorkStart758 <- Participant758Weekday %>%
  filter(status == "AtWork-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(WorkStart758) = c("Dates", "WorkStart")
```

```{r, eval=FALSE}
P758WeekdaySummary$WorkStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkStart758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$WorkStart[as.character(P758WeekdaySummary$Dates)
                                       == i] =
        WorkStart758$WorkStart[as.character(WorkStart758$Dates) == i]
      
    }
  }
}
```

#### WorkEnd

```{r, eval=FALSE}
WorkEnd758 <- Participant758Weekday %>%
  filter(status == "AtWork-Awake" & minutes != 0 & minutes > 720) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

names(WorkEnd758) = c("Dates", "WorkEnd")
```

```{r, eval=FALSE}
P758WeekdaySummary$WorkEnd <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkEnd758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$WorkEnd[as.character(P758WeekdaySummary$Dates)
                                       == i] =
        WorkEnd758$WorkEnd[as.character(WorkEnd758$Dates) == i]
      
    }
  }
}
```

### Tidy data

```{r, eval=FALSE}
Participant758Weekday$status[Participant758Weekday$status == "AtRestaurant-PrepareToSleep"] <- "AtRestaurant-Awake"

```

### Lunch

```{r, eval=FALSE}
Lunch758 <- Participant758Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Lunch758) = c("Dates", "LunchStart")
```

```{r, eval=FALSE}
Lunch758$LunchEnd<- Participant758Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P758WeekdaySummary$LunchStart <- NA

P758WeekdaySummary$LunchEnd <- NA
```

```{r, eval=FALSE}
names(Lunch758) = c("Dates", "LunchStart", "LunchEnd")
```

```{r, eval=FALSE}
Lunch758$LunchEnd <- as.data.frame(Lunch758$LunchEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Lunch758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$LunchStart[as.character(P758WeekdaySummary$Dates)
                                       == i] =
        Lunch758$LunchStart[as.character(Lunch758$Dates) == i]
      
      P758WeekdaySummary$LunchEnd[as.character(P758WeekdaySummary$Dates)
                                     == i] = 
        Lunch758$LunchEnd[as.character(Lunch758$Dates) == i]
    }
  }
}
```


### Dinner

```{r, eval=FALSE}
Dinner758 <- Participant758Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes >960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Dinner758) = c("Dates", "DinnerStart")
```

```{r, eval=FALSE}
Dinner758$DinnerEnd<- Participant758Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes > 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P758WeekdaySummary$DinnerStart <- NA

P758WeekdaySummary$DinnerEnd <- NA
```

```{r, eval=FALSE}
names(Dinner758) = c("Dates", "DinnerStart", "DinnerEnd")
```

```{r, eval=FALSE}
Dinner758$DinnerEnd <- as.data.frame(Dinner758$DinnerEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Dinner758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$DinnerStart[as.character(P758WeekdaySummary$Dates)
                                        == i] =
        Dinner758$DinnerStart[as.character(Dinner758$Dates) == i]
      
      P758WeekdaySummary$DinnerEnd[as.character(P758WeekdaySummary$Dates)
                                      == i] = 
        Dinner758$DinnerEnd[as.character(Dinner758$Dates) == i]
    }
  }
}
```


### Recreation 

```{r, eval=FALSE}
Participant758Weekday$status[Participant758Weekday$status == "AtRecreation-PrepareToSleep"] = "AtRecreation-Awake"
```

```{r, eval=FALSE}
Recreation758 <- Participant758Weekday %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(Recreation758) = c("Dates", "RecreationStart")
```

```{r, eval=FALSE}
Recreation758$RecreationEnd<- Participant758Weekday %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24" ) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P758WeekdaySummary$RecreationStart <- NA

P758WeekdaySummary$RecreationEnd <- NA
```

```{r, eval=FALSE}
names(Recreation758) = c("Dates", "RecreationStart", "RecreationEnd")
```

```{r, eval=FALSE}
Recreation758$RecreationEnd <- as.data.frame(Recreation758$RecreationEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Recreation758$Dates)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$RecreationStart[
        as.character(P758WeekdaySummary$Dates) == i] =
        Recreation758$RecreationStart[as.character(Recreation758$Dates) == i]
      
      P758WeekdaySummary$RecreationEnd[
        as.character(P758WeekdaySummary$Dates) == i] = 
        Recreation758$RecreationEnd[as.character(Recreation758$Dates) == i]
    }
  }
}
```

### Prepare to Sleep

```{r, eval=FALSE}

PrepareToSleep<- Participant758Weekday %>%
  filter(status == "AtHome-PrepareToSleep" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

```

```{r, eval=FALSE}
P758WeekdaySummary$PrepareToSleep <- NA

```

```{r, eval=FALSE}
for (i in as.character(PrepareToSleep$date)) {
  for (g in as.character(P758WeekdaySummary$Dates)) {
    if (g == i) {
      P758WeekdaySummary$PrepareToSleep[
        as.character(P758WeekdaySummary$Dates) == i] = 
        PrepareToSleep$minutes[as.character(PrepareToSleep$date) == i]
      
    }
  }
}

```
### Further Cleaning

```{r, eval=FALSE}
P758WeekdaySummary$Sleep <- 
  as.data.frame(P758WeekdaySummary$Sleep)[[1]]

P758WeekdaySummary$Backhome <- 
  as.data.frame(P758WeekdaySummary$Backhome)[[1]]


```

```{r, eval=FALSE}
P758WeekdaySummary$StartSleep <- 0

```

```{r, eval=FALSE}
Clean758 <- as.data.frame(lapply(P758WeekdaySummary, as.integer))
```

```{r, echo=FALSE, eval=FALSE}
write_rds(Clean758,
          "data/rds/Weekday758.rds")

```

```{r, echo=FALSE}
Weekday758 <- read_rds("data/rds/Weekday758.rds")

```

## Visibook

```{r}

p1 <- visielse(Weekday758, informer = NULL)
b1 <- ConvertFromViSibook(p1@book)

```


```{r}
b1 <- b1[order(as.numeric(b1$showorder)), ] # order the data.frame 
b1$label <- c("Wake Up", "Sleep", "Day Transport", "Evening Transport",
              "Reach Home", "Start Work", "End Work", "Start Lunch",
              "End Lunch", "Start Dinner", "End Dinner", "Start Recreation",
              "End Recreation", "Prepare To Sleep", "Start Sleeping")

```

```{r}
b1[16,] <- c("sleep", "Sleeping", "l", 1, "StartSleep", "WakeUp")
b1[17,] <- c("work", "Working", "l", 6, "WorkStart", "WorkEnd")
b1[18,] <- c("lunch", "Lunch break", "l", 7, "LunchStart", "LunchEnd")
b1[19,] <- c("dinner", "Dinner", "l", 10, "DinnerStart", "DinnerEnd")
b1$showorder <- c(2, NA, 3, 8, 10, 4, 6, NA, NA, NA, NA, 12, 13, 11, NA, 1,
                  5,7,9) 
b1 <- b1[order(as.numeric(b1$showorder)), ]
```

```{r}
v2 <- visielse(Weekday758, 
               book = b1, 
               informer = "median", 
               doplot = F, 
               pixel = 30)
plot(v2, 
     vp0w = 0.7, 
     unit.tps = "min", 
     scal.unit.tps = 30, 
     main = "Typical Weekday for Participant 758")
```

### Comments

From the visualization it can be seen that the participant is very routine in terms of their when they wake up and head to bed. However, it can be seen that their lunch time is quite erratic. Working hours is very routine as well. One interesting observation is that there are times when the participant heads out to dinner. These occurrences are few and not routine. Furthermore, the start and end of their reacreation period is also not regular, indicating that it may differ depending on the day of the week.

# Participant 113 Weekday

## Data Prep for Participant 113 Weekday

### Create minutes and date column 

```{r, eval=FALSE}
Participant113Weekday <- Participant113Weekday %>%
  mutate(minutes = hour(timestamp)*60 + minute(timestamp))
```

```{r, eval=FALSE}
Participant113Weekday <- Participant113Weekday %>%
  mutate(date = date(timestamp))
```

```{r, eval=FALSE}
Participant113Weekday$status <- paste(Participant113Weekday$currentMode, 
                               Participant113Weekday$sleepStatus, sep="-")
```

### Wake up

```{r, eval=FALSE}
P113WeekdaySummary <- Participant113Weekday %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(P113WeekdaySummary) = c("Dates", "WakeUp")
```

```{r, eval=FALSE}
P113WeekdaySummary$Sleep <- Participant113Weekday %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

### Transport

#### Transport Day Start

```{r, eval=FALSE}
TransportWeekDay113 <- Participant113Weekday %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes <= 720) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekDay113) = c("Dates", "TransportDayStart")
```

```{r, eval=FALSE}
P113WeekdaySummary$TransportDayStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekDay113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$TransportDayStart[as.character(P113WeekdaySummary$Dates)
                                       == i] =
        TransportWeekDay113$TransportDayStart[as.character(TransportWeekDay113$Dates) == i]
      
    }
  }
}
```

#### Transport Evening Start

```{r, eval=FALSE}
TransportWeekDay113 <- Participant113Weekday %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes > 1035) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekDay113) = c("Dates", "TransportEveningStart")
```

```{r, eval=FALSE}
P113WeekdaySummary$TransportEveningStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekDay113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$TransportEveningStart[as.character(P113WeekdaySummary$Dates)
                                       == i] =
        TransportWeekDay113$TransportEveningStart[as.character(TransportWeekDay113$Dates) == i]
      
    }
  }
}
```

#### Back Home

```{r, eval=FALSE}
P113WeekdaySummary$Backhome <- Participant113Weekday %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

#### WorkStart

```{r, eval=FALSE}
WorkStart113 <- Participant113Weekday %>%
  filter(status == "AtWork-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(WorkStart113) = c("Dates", "WorkStart")
```

```{r, eval=FALSE}
P113WeekdaySummary$WorkStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkStart113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$WorkStart[as.character(P113WeekdaySummary$Dates)
                                       == i] =
        WorkStart113$WorkStart[as.character(WorkStart113$Dates) == i]
      
    }
  }
}
```

#### WorkEnd

```{r, eval=FALSE}
WorkEnd113 <- Participant113Weekday %>%
  filter(status == "AtWork-Awake" & minutes != 0 & minutes > 720) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

names(WorkEnd113) = c("Dates", "WorkEnd")
```

```{r, eval=FALSE}
P113WeekdaySummary$WorkEnd <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkEnd113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$WorkEnd[as.character(P113WeekdaySummary$Dates)
                                       == i] =
        WorkEnd113$WorkEnd[as.character(WorkEnd113$Dates) == i]
      
    }
  }
}
```

### Tidy data

```{r, eval=FALSE}
Participant113Weekday$status[Participant113Weekday$status == "AtRestaurant-PrepareToSleep"] <- "AtRestaurant-Awake"

```

### Lunch

```{r, eval=FALSE}
Lunch113 <- Participant113Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Lunch113) = c("Dates", "LunchStart")
```

```{r, eval=FALSE}
Lunch113$LunchEnd<- Participant113Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P113WeekdaySummary$LunchStart <- NA

P113WeekdaySummary$LunchEnd <- NA
```

```{r, eval=FALSE}
names(Lunch113) = c("Dates", "LunchStart", "LunchEnd")
```

```{r, eval=FALSE}
Lunch113$LunchEnd <- as.data.frame(Lunch113$LunchEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Lunch113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$LunchStart[as.character(P113WeekdaySummary$Dates)
                                       == i] =
        Lunch113$LunchStart[as.character(Lunch113$Dates) == i]
      
      P113WeekdaySummary$LunchEnd[as.character(P113WeekdaySummary$Dates)
                                     == i] = 
        Lunch113$LunchEnd[as.character(Lunch113$Dates) == i]
    }
  }
}
```


### Dinner

```{r, eval=FALSE}
Dinner113 <- Participant113Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes >960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Dinner113) = c("Dates", "DinnerStart")
```

```{r, eval=FALSE}
Dinner113$DinnerEnd<- Participant113Weekday %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes > 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P113WeekdaySummary$DinnerStart <- NA

P113WeekdaySummary$DinnerEnd <- NA
```

```{r, eval=FALSE}
names(Dinner113) = c("Dates", "DinnerStart", "DinnerEnd")
```

```{r, eval=FALSE}
Dinner113$DinnerEnd <- as.data.frame(Dinner113$DinnerEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Dinner113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$DinnerStart[as.character(P113WeekdaySummary$Dates)
                                        == i] =
        Dinner113$DinnerStart[as.character(Dinner113$Dates) == i]
      
      P113WeekdaySummary$DinnerEnd[as.character(P113WeekdaySummary$Dates)
                                      == i] = 
        Dinner113$DinnerEnd[as.character(Dinner113$Dates) == i]
    }
  }
}
```


### Recreation 

```{r, eval=FALSE}
Participant113Weekday$status[Participant113Weekday$status == "AtRecreation-PrepareToSleep"] = "AtRecreation-Awake"
```

```{r, eval=FALSE}
Recreation113 <- Participant113Weekday %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(Recreation113) = c("Dates", "RecreationStart")
```

```{r, eval=FALSE}
Recreation113$RecreationEnd<- Participant113Weekday %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24" ) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P113WeekdaySummary$RecreationStart <- NA

P113WeekdaySummary$RecreationEnd <- NA
```

```{r, eval=FALSE}
names(Recreation113) = c("Dates", "RecreationStart", "RecreationEnd")
```

```{r, eval=FALSE}
Recreation113$RecreationEnd <- as.data.frame(Recreation113$RecreationEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Recreation113$Dates)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$RecreationStart[
        as.character(P113WeekdaySummary$Dates) == i] =
        Recreation113$RecreationStart[as.character(Recreation113$Dates) == i]
      
      P113WeekdaySummary$RecreationEnd[
        as.character(P113WeekdaySummary$Dates) == i] = 
        Recreation113$RecreationEnd[as.character(Recreation113$Dates) == i]
    }
  }
}
```

### Prepare to Sleep

```{r, eval=FALSE}

PrepareToSleep<- Participant113Weekday %>%
  filter(status == "AtHome-PrepareToSleep" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

```

```{r, eval=FALSE}
P113WeekdaySummary$PrepareToSleep <- NA

```

```{r, eval=FALSE}
for (i in as.character(PrepareToSleep$date)) {
  for (g in as.character(P113WeekdaySummary$Dates)) {
    if (g == i) {
      P113WeekdaySummary$PrepareToSleep[
        as.character(P113WeekdaySummary$Dates) == i] = 
        PrepareToSleep$minutes[as.character(PrepareToSleep$date) == i]
      
    }
  }
}

```
### Further Cleaning

```{r, eval=FALSE}
P113WeekdaySummary$Sleep <- 
  as.data.frame(P113WeekdaySummary$Sleep)[[1]]

P113WeekdaySummary$Backhome <- 
  as.data.frame(P113WeekdaySummary$Backhome)[[1]]


```

```{r, eval=FALSE}
P113WeekdaySummary$StartSleep <- 0

```

```{r, eval=FALSE}
Clean113 <- as.data.frame(lapply(P113WeekdaySummary, as.integer))
```

```{r, echo=FALSE, eval=FALSE}
write_rds(Clean113,
          "data/rds/Weekday113.rds")

```

```{r, echo=FALSE}
Weekday113 <- read_rds("data/rds/Weekday113.rds")

```

## Visibook

```{r}

p1 <- visielse(Weekday113, informer = NULL)
b1 <- ConvertFromViSibook(p1@book)

```


```{r}
b1 <- b1[order(as.numeric(b1$showorder)), ] # order the data.frame 
b1$label <- c("Wake Up", "Sleep", "Day Transport", "Evening Transport",
              "Reach Home", "Start Work", "End Work", "Start Lunch",
              "End Lunch", "Start Dinner", "End Dinner", "Start Recreation",
              "End Recreation", "Prepare To Sleep", "Start Sleeping")

```

```{r}
b1[16,] <- c("sleep", "Sleeping", "l", 1, "StartSleep", "WakeUp")
b1[17,] <- c("work", "Working", "l", 6, "WorkStart", "WorkEnd")
b1[18,] <- c("lunch", "Lunch break", "l", 7, "LunchStart", "LunchEnd")
b1[19,] <- c("dinner", "Dinner", "l", 10, "DinnerStart", "DinnerEnd")
b1$showorder <- c(2, NA, 3, 8, 10, 4, 6, NA, NA, NA, NA, 12, 13, 11, NA, 1,
                  5,7,9) 
b1 <- b1[order(as.numeric(b1$showorder)), ]
```

```{r}
v2 <- visielse(Weekday113, 
               book = b1, 
               informer = "median", 
               doplot = F, 
               pixel = 30)
plot(v2, 
     vp0w = 0.7, 
     unit.tps = "min", 
     scal.unit.tps = 30, 
     main = "Typical Weekday for Participant 113")
```

# Participant 758 Weekend

## Data Prep for Participant 758 Weekend

### Create minutes and date column 

```{r, eval=FALSE}
Participant758Weekend <- Participant758Weekend %>%
  mutate(minutes = hour(timestamp)*60 + minute(timestamp))
```

```{r, eval=FALSE}
Participant758Weekend <- Participant758Weekend %>%
  mutate(date = date(timestamp))
```

```{r, eval=FALSE}
Participant758Weekend$status <- paste(Participant758Weekend$currentMode, 
                               Participant758Weekend$sleepStatus, sep="-")
```

### Wake up

```{r, eval=FALSE}
P758WeekendSummary <- Participant758Weekend %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(P758WeekendSummary) = c("Dates", "WakeUp")
```

```{r, eval=FALSE}
P758WeekendSummary$Sleep <- Participant758Weekend %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

### Transport

#### Transport Day Start

```{r, eval=FALSE}
TransportWeekend758 <- Participant758Weekend %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes <= 720) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekend758) = c("Dates", "TransportDayStart")
```

```{r, eval=FALSE}
P758WeekendSummary$TransportDayStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekend758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$TransportDayStart[as.character(P758WeekendSummary$Dates)
                                       == i] =
        TransportWeekend758$TransportDayStart[as.character(TransportWeekend758$Dates) == i]
      
    }
  }
}
```

#### Transport Evening Start

```{r, eval=FALSE}
TransportWeekend758 <- Participant758Weekend %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes > 1035) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekend758) = c("Dates", "TransportEveningStart")
```

```{r, eval=FALSE}
P758WeekendSummary$TransportEveningStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekend758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$TransportEveningStart[as.character(P758WeekendSummary$Dates)
                                       == i] =
        TransportWeekend758$TransportEveningStart[as.character(TransportWeekend758$Dates) == i]
      
    }
  }
}
```

#### Back Home

```{r, eval=FALSE}
P758WeekendSummary$Backhome <- Participant758Weekend %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

#### WorkStart

```{r, eval=FALSE}
WorkStart758 <- Participant758Weekend %>%
  filter(status == "AtWork-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(WorkStart758) = c("Dates", "WorkStart")
```

```{r, eval=FALSE}
P758WeekendSummary$WorkStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkStart758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$WorkStart[as.character(P758WeekendSummary$Dates)
                                       == i] =
        WorkStart758$WorkStart[as.character(WorkStart758$Dates) == i]
      
    }
  }
}
```

#### WorkEnd

```{r, eval=FALSE}
WorkEnd758 <- Participant758Weekend %>%
  filter(status == "AtWork-Awake" & minutes != 0 & minutes > 720) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

names(WorkEnd758) = c("Dates", "WorkEnd")
```

```{r, eval=FALSE}
P758WeekendSummary$WorkEnd <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkEnd758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$WorkEnd[as.character(P758WeekendSummary$Dates)
                                       == i] =
        WorkEnd758$WorkEnd[as.character(WorkEnd758$Dates) == i]
      
    }
  }
}
```

### Tidy data

```{r, eval=FALSE}
Participant758Weekend$status[Participant758Weekend$status == "AtRestaurant-PrepareToSleep"] <- "AtRestaurant-Awake"

```

### Lunch

```{r, eval=FALSE}
Lunch758 <- Participant758Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Lunch758) = c("Dates", "LunchStart")
```

```{r, eval=FALSE}
Lunch758$LunchEnd<- Participant758Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P758WeekendSummary$LunchStart <- NA

P758WeekendSummary$LunchEnd <- NA
```

```{r, eval=FALSE}
names(Lunch758) = c("Dates", "LunchStart", "LunchEnd")
```

```{r, eval=FALSE}
Lunch758$LunchEnd <- as.data.frame(Lunch758$LunchEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Lunch758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$LunchStart[as.character(P758WeekendSummary$Dates)
                                       == i] =
        Lunch758$LunchStart[as.character(Lunch758$Dates) == i]
      
      P758WeekendSummary$LunchEnd[as.character(P758WeekendSummary$Dates)
                                     == i] = 
        Lunch758$LunchEnd[as.character(Lunch758$Dates) == i]
    }
  }
}
```


### Dinner

```{r, eval=FALSE}
Dinner758 <- Participant758Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes >960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Dinner758) = c("Dates", "DinnerStart")
```

```{r, eval=FALSE}
Dinner758$DinnerEnd<- Participant758Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes > 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P758WeekendSummary$DinnerStart <- NA

P758WeekendSummary$DinnerEnd <- NA
```

```{r, eval=FALSE}
names(Dinner758) = c("Dates", "DinnerStart", "DinnerEnd")
```

```{r, eval=FALSE}
Dinner758$DinnerEnd <- as.data.frame(Dinner758$DinnerEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Dinner758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$DinnerStart[as.character(P758WeekendSummary$Dates)
                                        == i] =
        Dinner758$DinnerStart[as.character(Dinner758$Dates) == i]
      
      P758WeekendSummary$DinnerEnd[as.character(P758WeekendSummary$Dates)
                                      == i] = 
        Dinner758$DinnerEnd[as.character(Dinner758$Dates) == i]
    }
  }
}
```


### Recreation 

```{r, eval=FALSE}
Participant758Weekend$status[Participant758Weekend$status == "AtRecreation-PrepareToSleep"] = "AtRecreation-Awake"
```

```{r, eval=FALSE}
Recreation758 <- Participant758Weekend %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(Recreation758) = c("Dates", "RecreationStart")
```

```{r, eval=FALSE}
Recreation758$RecreationEnd<- Participant758Weekend %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24" ) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P758WeekendSummary$RecreationStart <- NA

P758WeekendSummary$RecreationEnd <- NA
```

```{r, eval=FALSE}
names(Recreation758) = c("Dates", "RecreationStart", "RecreationEnd")
```

```{r, eval=FALSE}
Recreation758$RecreationEnd <- as.data.frame(Recreation758$RecreationEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Recreation758$Dates)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$RecreationStart[
        as.character(P758WeekendSummary$Dates) == i] =
        Recreation758$RecreationStart[as.character(Recreation758$Dates) == i]
      
      P758WeekendSummary$RecreationEnd[
        as.character(P758WeekendSummary$Dates) == i] = 
        Recreation758$RecreationEnd[as.character(Recreation758$Dates) == i]
    }
  }
}
```

### Prepare to Sleep

```{r, eval=FALSE}

PrepareToSleep<- Participant758Weekend %>%
  filter(status == "AtHome-PrepareToSleep" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

```

```{r, eval=FALSE}
P758WeekendSummary$PrepareToSleep <- NA

```

```{r, eval=FALSE}
for (i in as.character(PrepareToSleep$date)) {
  for (g in as.character(P758WeekendSummary$Dates)) {
    if (g == i) {
      P758WeekendSummary$PrepareToSleep[
        as.character(P758WeekendSummary$Dates) == i] = 
        PrepareToSleep$minutes[as.character(PrepareToSleep$date) == i]
      
    }
  }
}

```
### Further Cleaning

```{r, eval=FALSE}
P758WeekendSummary$Sleep <- 
  as.data.frame(P758WeekendSummary$Sleep)[[1]]

P758WeekendSummary$Backhome <- 
  as.data.frame(P758WeekendSummary$Backhome)[[1]]


```

```{r, eval=FALSE}
P758WeekendSummary$StartSleep <- 0

```

```{r, eval=FALSE}
Clean758 <- as.data.frame(lapply(P758WeekendSummary, as.integer))
```

```{r, echo=FALSE, eval=FALSE}
write_rds(Clean758,
          "data/rds/Weekend758.rds")

```

```{r, echo=FALSE}
Weekend758 <- read_rds("data/rds/Weekend758.rds")

```

## Visibook

```{r}

p1 <- visielse(Weekend758, informer = NULL)
b1 <- ConvertFromViSibook(p1@book)

```


```{r}
b1 <- b1[order(as.numeric(b1$showorder)), ] # order the data.frame 
b1$label <- c("Wake Up", "Sleep", "Day Transport", "Evening Transport",
              "Reach Home", "Start Work", "End Work", "Start Lunch",
              "End Lunch", "Start Dinner", "End Dinner", "Start Recreation",
              "End Recreation", "Prepare To Sleep", "Start Sleeping")

```

```{r}
b1[16,] <- c("sleep", "Sleeping", "l", 1, "StartSleep", "WakeUp")
b1[17,] <- c("work", "Working", "l", 6, "WorkStart", "WorkEnd")
b1[18,] <- c("lunch", "Lunch break", "l", 7, "LunchStart", "LunchEnd")
b1[19,] <- c("dinner", "Dinner", "l", 10, "DinnerStart", "DinnerEnd")
b1$showorder <- c(2, NA, 3, 8, 10, 4, 6, NA, NA, NA, NA, 12, 13, 11, NA, 1,
                  5,7,9) 
b1 <- b1[order(as.numeric(b1$showorder)), ]
```

```{r}
v2 <- visielse(Weekend758, 
               book = b1, 
               informer = "median", 
               doplot = F, 
               pixel = 30)
plot(v2, 
     vp0w = 0.7, 
     unit.tps = "min", 
     scal.unit.tps = 30, 
     main = "Typical Weekend for Participant 758")
```
# Participant 113 Weekend

## Data Prep for Participant 113 Weekend

### Create minutes and date column 

```{r, eval=FALSE}
Participant113Weekend <- Participant113Weekend %>%
  mutate(minutes = hour(timestamp)*60 + minute(timestamp))
```

```{r, eval=FALSE}
Participant113Weekend <- Participant113Weekend %>%
  mutate(date = date(timestamp))
```

```{r, eval=FALSE}
Participant113Weekend$status <- paste(Participant113Weekend$currentMode, 
                               Participant113Weekend$sleepStatus, sep="-")
```

### Wake up

```{r, eval=FALSE}
P113WeekendSummary <- Participant113Weekend %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(P113WeekendSummary) = c("Dates", "WakeUp")
```

```{r, eval=FALSE}
P113WeekendSummary$Sleep <- Participant113Weekend %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

### Transport

#### Transport Day Start

```{r, eval=FALSE}
TransportWeekend113 <- Participant113Weekend %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes <= 720) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekend113) = c("Dates", "TransportDayStart")
```

```{r, eval=FALSE}
P113WeekendSummary$TransportDayStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekend113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$TransportDayStart[as.character(P113WeekendSummary$Dates)
                                       == i] =
        TransportWeekend113$TransportDayStart[as.character(TransportWeekend113$Dates) == i]
      
    }
  }
}
```

#### Transport Evening Start

```{r, eval=FALSE}
TransportWeekend113 <- Participant113Weekend %>%
  filter(status == "Transport-Awake" & minutes != 0 & minutes > 1035) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(TransportWeekend113) = c("Dates", "TransportEveningStart")
```

```{r, eval=FALSE}
P113WeekendSummary$TransportEveningStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(TransportWeekend113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$TransportEveningStart[as.character(P113WeekendSummary$Dates)
                                       == i] =
        TransportWeekend113$TransportEveningStart[as.character(TransportWeekend113$Dates) == i]
      
    }
  }
}
```

#### Back Home

```{r, eval=FALSE}
P113WeekendSummary$Backhome <- Participant113Weekend %>%
  filter(status == "AtHome-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

#### WorkStart

```{r, eval=FALSE}
WorkStart113 <- Participant113Weekend %>%
  filter(status == "AtWork-Awake" & minutes != 0) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(WorkStart113) = c("Dates", "WorkStart")
```

```{r, eval=FALSE}
P113WeekendSummary$WorkStart <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkStart113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$WorkStart[as.character(P113WeekendSummary$Dates)
                                       == i] =
        WorkStart113$WorkStart[as.character(WorkStart113$Dates) == i]
      
    }
  }
}
```

#### WorkEnd

```{r, eval=FALSE}
WorkEnd113 <- Participant113Weekend %>%
  filter(status == "AtWork-Awake" & minutes != 0 & minutes > 720) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

names(WorkEnd113) = c("Dates", "WorkEnd")
```

```{r, eval=FALSE}
P113WeekendSummary$WorkEnd <- NA
```

```{r, eval=FALSE}

for (i in as.character(WorkEnd113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$WorkEnd[as.character(P113WeekendSummary$Dates)
                                       == i] =
        WorkEnd113$WorkEnd[as.character(WorkEnd113$Dates) == i]
      
    }
  }
}
```

### Tidy data

```{r, eval=FALSE}
Participant113Weekend$status[Participant113Weekend$status == "AtRestaurant-PrepareToSleep"] <- "AtRestaurant-Awake"

```

### Lunch

```{r, eval=FALSE}
Lunch113 <- Participant113Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Lunch113) = c("Dates", "LunchStart")
```

```{r, eval=FALSE}
Lunch113$LunchEnd<- Participant113Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes <= 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P113WeekendSummary$LunchStart <- NA

P113WeekendSummary$LunchEnd <- NA
```

```{r, eval=FALSE}
names(Lunch113) = c("Dates", "LunchStart", "LunchEnd")
```

```{r, eval=FALSE}
Lunch113$LunchEnd <- as.data.frame(Lunch113$LunchEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Lunch113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$LunchStart[as.character(P113WeekendSummary$Dates)
                                       == i] =
        Lunch113$LunchStart[as.character(Lunch113$Dates) == i]
      
      P113WeekendSummary$LunchEnd[as.character(P113WeekendSummary$Dates)
                                     == i] = 
        Lunch113$LunchEnd[as.character(Lunch113$Dates) == i]
    }
  }
}
```


### Dinner

```{r, eval=FALSE}
Dinner113 <- Participant113Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes >960) %>%
  group_by(date) %>%
  summarise(minutes = min(minutes))

names(Dinner113) = c("Dates", "DinnerStart")
```

```{r, eval=FALSE}
Dinner113$DinnerEnd<- Participant113Weekend %>%
  filter(status == "AtRestaurant-Awake" & minutes != 0 & date != "2023-05-24" 
         & minutes > 960) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P113WeekendSummary$DinnerStart <- NA

P113WeekendSummary$DinnerEnd <- NA
```

```{r, eval=FALSE}
names(Dinner113) = c("Dates", "DinnerStart", "DinnerEnd")
```

```{r, eval=FALSE}
Dinner113$DinnerEnd <- as.data.frame(Dinner113$DinnerEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Dinner113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$DinnerStart[as.character(P113WeekendSummary$Dates)
                                        == i] =
        Dinner113$DinnerStart[as.character(Dinner113$Dates) == i]
      
      P113WeekendSummary$DinnerEnd[as.character(P113WeekendSummary$Dates)
                                      == i] = 
        Dinner113$DinnerEnd[as.character(Dinner113$Dates) == i]
    }
  }
}
```


### Recreation 

```{r, eval=FALSE}
Participant113Weekend$status[Participant113Weekend$status == "AtRecreation-PrepareToSleep"] = "AtRecreation-Awake"
```

```{r, eval=FALSE}
Recreation113 <- Participant113Weekend %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = min(minutes)) 

names(Recreation113) = c("Dates", "RecreationStart")
```

```{r, eval=FALSE}
Recreation113$RecreationEnd<- Participant113Weekend %>%
  filter(status == "AtRecreation-Awake" & minutes != 0 & date != "2023-05-24" ) %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) %>%
  select(minutes)
```

```{r, eval=FALSE}
P113WeekendSummary$RecreationStart <- NA

P113WeekendSummary$RecreationEnd <- NA
```

```{r, eval=FALSE}
names(Recreation113) = c("Dates", "RecreationStart", "RecreationEnd")
```

```{r, eval=FALSE}
Recreation113$RecreationEnd <- as.data.frame(Recreation113$RecreationEnd)[[1]]
```

```{r, eval=FALSE}

for (i in as.character(Recreation113$Dates)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$RecreationStart[
        as.character(P113WeekendSummary$Dates) == i] =
        Recreation113$RecreationStart[as.character(Recreation113$Dates) == i]
      
      P113WeekendSummary$RecreationEnd[
        as.character(P113WeekendSummary$Dates) == i] = 
        Recreation113$RecreationEnd[as.character(Recreation113$Dates) == i]
    }
  }
}
```

### Prepare to Sleep

```{r, eval=FALSE}

PrepareToSleep<- Participant113Weekend %>%
  filter(status == "AtHome-PrepareToSleep" & minutes != 0 & date != "2023-05-24") %>%
  group_by(date) %>%
  summarise(minutes = max(minutes)) 

```

```{r, eval=FALSE}
P113WeekendSummary$PrepareToSleep <- NA

```

```{r, eval=FALSE}
for (i in as.character(PrepareToSleep$date)) {
  for (g in as.character(P113WeekendSummary$Dates)) {
    if (g == i) {
      P113WeekendSummary$PrepareToSleep[
        as.character(P113WeekendSummary$Dates) == i] = 
        PrepareToSleep$minutes[as.character(PrepareToSleep$date) == i]
      
    }
  }
}

```
### Further Cleaning

```{r, eval=FALSE}
P113WeekendSummary$Sleep <- 
  as.data.frame(P113WeekendSummary$Sleep)[[1]]

P113WeekendSummary$Backhome <- 
  as.data.frame(P113WeekendSummary$Backhome)[[1]]


```

```{r, eval=FALSE}
P113WeekendSummary$StartSleep <- 0

```

```{r, eval=FALSE}
Clean113 <- as.data.frame(lapply(P113WeekendSummary, as.integer))
```

```{r, echo=FALSE, eval=FALSE}
write_rds(Clean113,
          "data/rds/Weekend113.rds")

```

```{r, echo=FALSE}
Weekend113 <- read_rds("data/rds/Weekend113.rds")

```

## Visibook

```{r}

p1 <- visielse(Weekend113, informer = NULL)
b1 <- ConvertFromViSibook(p1@book)

```

```{r}
b1 <- b1[order(as.numeric(b1$showorder)), ] # order the data.frame 
b1$label <- c("Wake Up", "Sleep", "Day Transport", "Evening Transport",
              "Reach Home", "Start Work", "End Work", "Start Lunch",
              "End Lunch", "Start Dinner", "End Dinner", "Start Recreation",
              "End Recreation", "Prepare To Sleep", "Start Sleeping")

```

```{r}
b1[16,] <- c("sleep", "Sleeping", "l", 1, "StartSleep", "WakeUp")
b1[17,] <- c("work", "Working", "l", 6, "WorkStart", "WorkEnd")
b1[18,] <- c("lunch", "Lunch break", "l", 7, "LunchStart", "LunchEnd")
b1[19,] <- c("dinner", "Dinner", "l", 10, "DinnerStart", "DinnerEnd")
b1$showorder <- c(2, NA, 3, 8, 10, 4, 6, NA, NA, NA, NA, 12, 13, 11, NA, 1,
                  5,7,9) 
b1 <- b1[order(as.numeric(b1$showorder)), ]
```

```{r}
v2 <- visielse(Weekend113, 
               book = b1, 
               informer = "median", 
               doplot = F, 
               pixel = 30)
plot(v2, 
     vp0w = 0.7, 
     unit.tps = "min", 
     scal.unit.tps = 30, 
     main = "Typical Weekend for Participant 113")
```